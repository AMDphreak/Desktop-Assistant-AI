The nature of the security vulnerability is in speculative execution of else branches in a batch script.

The Powershell script parser executes code in the else branch of an if statement even when the if statement evaluates to true. Any user input prompts in the else branch cause are executed after the if branch finishes. All code after the input prompt executes visibly, if the user provides an input (blank or otherwise). The lines before the user input in the else branch are executed silently, meaning this can be used to execute malicious code silently.

While it is likely that a user running a script should already know whether the programmer is trustworthy, this exploit can be used by bad actors in legitimate organizations to patch legitimate software with malicious code that runs automatically on update via command line. A malicious actor can use this exploit to patch other scripts on the machine with their own malicious code, making their attack recurrent and spreadable via legitimate update pathways.

Because Powershell is also available on Linux, this attack may be applicable to Linux systems where a script may be given elevated execute permissions via sudo.

additional reading:
https://subscription.packtpub.com/book/security/9781835082454/20/ch20lvl1sec14/using-powershell-for-privilege-escalation-in-linux